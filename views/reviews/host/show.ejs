<%- include("../../partials/header") %>

<p style="font-size:115%;">
	<a href="/search/<%=apartment._id%>"
	   style="margin-left:1%; color:crimson; font-size:110%; text-decoration:none;">
		&lt; <%= apartment.name %></a>
</p><br>

<div class="container">
	<div class="row">
		<div class="col-md-9">
			<div class="well">
				<div class="text-right">
					<% var str_host = JSON.stringify(host); %>
					<a href="/reviews/host/new?host=<%=str_host%>&apartment=<%=apartment._id%>"
					   class="btn btn-success">
						Add New Review </a>
				</div>
				<%	host.reviews.forEach(function(review){ %>
				<div class="row">
					<div class="col-md-12">
						<strong> <%= review.author.username %> </strong>
						<span class="pull-right"><%= review.date %></span>
							<% var stars = review.rating
							for(var i=1; i<10; i+=2){
								if((stars % 2) == 0){
									if( i < stars ) { %>
										<span class="fa fa-star" style="color:gold"></span>
									<% }else{ %>
										<span class="far fa-star" style="color:gold"></span>
									<%	}
								}else{
									if( i == stars) {%>
										<span class="fa fa-star-half-o" style="color:gold"></span>
									<% }else if(i < stars){ %>
										<span class="fa fa-star" style="color:gold"></span>
									<%	}else{ %>
										<span class="far fa-star" style="color:gold"></span>
									<%	}
									}
								}  %>
							<p>
								<%= review.text %>
							</p>
							<% if(currentUser && review.author._id.equals(currentUser._id)){ %>
								<a class="btn btn-xs btn-warning"
								   href="/reviews/host/<%=review._id%>/edit?host=<%=str_host%>&apartment=<%=apartment._id%>">
									Edit
								</a>
								<form action="/reviews/host/<%=review._id%>?_method=DELETE&host=<%=host._id%>&apartment=<%=apartment._id%>" 
									  method="POST">
									<input type="submit" class="btn btn-xs btn-danger" 
										   value="Delete">
								</form>
								<br>
							<% } %>
						</div>
					</div>
				<% }) %>
			</div>
		</div>
	</div>
</div>

<%- include("../../partials/footer") %>
